<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NBA DATA 2024-25 前100名球員數據儀表板</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            color: #333;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 0;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        h1 {
            text-align: center;
            font-size: 2.8em;
            background: linear-gradient(45deg, #1e3c72, #2a5298);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .subtitle {
            text-align: center;
            color: #666;
            font-size: 1.1em;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
        }

        .search-container {
            position: relative;
            flex: 1;
            max-width: 400px;
        }

        input[type="text"] {
            width: 100%;
            padding: 15px 50px 15px 20px;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 16px;
            transition: all 0.3s;
            background: white;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #2a5298;
            box-shadow: 0 0 0 3px rgba(42, 82, 152, 0.1);
        }

        .search-icon {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
            font-size: 18px;
        }

        select {
            padding: 15px 20px;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 16px;
            background: white;
            cursor: pointer;
            min-width: 150px;
        }

        button {
            background: linear-gradient(45deg, #1e3c72, #2a5298);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
            min-width: 120px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(42, 82, 152, 0.3);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .stats-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #1e3c72;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .players-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .player-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.1);
            transition: all 0.3s;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            position: relative;
            height: 350px;
            cursor: pointer;
            perspective: 1000px;
        }

        .player-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.8s;
            transform-style: preserve-3d;
        }

        .player-card.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 20px;
            padding: 25px;
            display: flex;
            flex-direction: column;
        }

        .card-front {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            justify-content: center;
            align-items: center;
        }

        .card-back {
            background: rgba(255, 255, 255, 0.95);
            transform: rotateY(180deg);
            overflow-y: auto;
        }

        .player-photo {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 4px solid rgba(255, 255, 255, 0.3);
            margin-bottom: 20px;
            object-fit: cover;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
        }

        .card-front .player-name {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .card-front .player-team {
            font-size: 1.1em;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .card-front .hoopshype-rank {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
            backdrop-filter: blur(10px);
        }

        .flip-hint {
            position: absolute;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8em;
            opacity: 0.7;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        .ranking-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            z-index: 10;
        }

        .top-10 {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #333;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.5);
        }

        .top-25 {
            background: linear-gradient(45deg, #c0c0c0, #e8e8e8);
            color: #333;
            box-shadow: 0 4px 15px rgba(192, 192, 192, 0.5);
        }

        .top-50 {
            background: linear-gradient(45deg, #cd7f32, #deb887);
            color: white;
            box-shadow: 0 4px 15px rgba(205, 127, 50, 0.5);
        }

        .card-back .player-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .card-back .player-name {
            font-size: 1.4em;
            font-weight: bold;
            color: #1e3c72;
        }

        .card-back .player-position {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .player-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
        }

        .info-label {
            color: #666;
            font-size: 0.9em;
        }

        .info-value {
            font-weight: bold;
            color: #333;
        }

        .advanced-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 10px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 10px;
        }

        .stat-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #1e3c72;
            margin-bottom: 5px;
        }

        .stat-name {
            font-size: 0.8em;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .placeholder-card {
            opacity: 0.7;
            border: 2px dashed #ccc;
        }

        .placeholder-card .card-front {
            background: #ccc;
        }

        .placeholder-content {
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .loading {
            text-align: center;
            padding: 50px;
            color: white;
            font-size: 1.2em;
        }

        .loading-spinner {
            border: 4px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top: 4px solid white;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            background: #ff6b6b;
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
        }

        .no-results {
            text-align: center;
            padding: 50px;
            color: white;
            font-size: 1.2em;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin: 30px 0;
        }

        .page-btn {
            background: rgba(255, 255, 255, 0.9);
            color: #1e3c72;
            border: 2px solid #1e3c72;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 40px;
            text-align: center;
        }

        .page-btn:hover, .page-btn.active {
            background: #1e3c72;
            color: white;
        }

        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        @media (max-width: 768px) {
            .players-grid {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .search-container {
                max-width: 100%;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .advanced-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <h1>🏀 NBA data 2024-25 前100名球員</h1>
            <p class="subtitle">
                NBA球員完整統計數據
            </p>
            
            <div class="controls">
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="搜尋球員姓名...">
                    <span class="search-icon">🔍</span>
                </div>
                
                <select id="teamFilter">
                    <option value="">所有球隊</option>
                </select>
                
                <select id="rankFilter">
                    <option value="">所有排名</option>
                    <option value="1-10">前10名</option>
                    <option value="11-25">11-25名</option>
                    <option value="26-50">26-50名</option>
                    <option value="51-100">51-100名</option>
                </select>
                
                <select id="dataTypeSelect">
                    <option value="advanced">進階統計</option>
                    <option value="totals">基本統計</option>
                </select>
                
                <button onclick="loadPlayers()">載入數據</button>
                <button onclick="clearFilters()">清除篩選</button>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="stats-summary" id="statsSummary" style="display: none;">
            <div class="stat-card">
                <div class="stat-number" id="totalPlayers">0</div>
                <div class="stat-label">TOP 100 球員</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="avgAge">0</div>
                <div class="stat-label">平均年齡</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalTeams">0</div>
                <div class="stat-label">球隊數量</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="avgPER">0</div>
                <div class="stat-label">平均PER</div>
            </div>
        </div>

        <div id="loadingDiv" class="loading" style="display: none;">
            <div class="loading-spinner"></div>
            正在載入NBA前100名球員數據...
        </div>

        <div id="errorDiv" class="error" style="display: none;"></div>

        <div class="pagination" id="pagination" style="display: none;"></div>

        <div class="players-grid" id="playersContainer"></div>

        <div class="pagination" id="paginationBottom" style="display: none;"></div>
    </div>

    <script>
        // HoopsHype 2024-25 前100名球員名單 (包含API名稱映射)
        const top100Players = [
            "Nikola Jokic", "Luka Doncic", "Shai Gilgeous-Alexander", "Giannis Antetokounmpo", "Joel Embiid",
            "Jayson Tatum", "Anthony Edwards", "Jalen Brunson", "Anthony Davis", "Victor Wembanyama",
            "Kevin Durant", "Tyrese Haliburton", "LeBron James", "Stephen Curry", "Tyrese Maxey",
            "Devin Booker", "Donovan Mitchell", "Jaylen Brown", "Ja Morant", "Domantas Sabonis",
            "Damian Lillard", "Zion Williamson", "Paolo Banchero", "De'Aaron Fox", "Pascal Siakam",
            "Kawhi Leonard", "Paul George", "Bam Adebayo", "Trae Young", "Jimmy Butler",
            "Karl-Anthony Towns", "Rudy Gobert", "Kyrie Irving", "Lauri Markkanen", "Scottie Barnes",
            "Jamal Murray", "Cade Cunningham", "Julius Randle", "Alperen Sengun", "Chet Holmgren",
            "LaMelo Ball", "Jaren Jackson Jr", "Jalen Williams", "Kristaps Porzingis", "DeMar DeRozan",
            "Brandon Ingram", "James Harden", "Franz Wagner", "Desmond Bane", "Derrick White",
            "Evan Mobley", "Darius Garland", "Myles Turner", "Jrue Holiday", "Dejounte Murray",
            "Mikal Bridges", "OG Anunoby", "Brandon Miller", "Aaron Gordon", "Jarrett Allen",
            "Kyle Kuzma", "Zach LaVine", "Austin Reaves", "Michael Porter Jr", "Jalen Green",
            "Fred VanVleet", "Miles Bridges", "Jalen Johnson", "Tyler Herro", "Coby White",
            "CJ McCollum", "Josh Giddey", "Bradley Beal", "Trey Murphy", "D'Angelo Russell",
            "Devin Vassell", "Immanuel Quickley", "Herb Jones", "Jaden McDaniels", "Jerami Grant",
            "Josh Hart", "Keegan Murray", "Jonathan Kuminga", "Malik Monk", "Cam Thomas",
            "Donte DiVincenzo", "Anfernee Simons", "Jabari Smith Jr", "Nikola Vucevic", "Tobias Harris",
            "Naz Reid", "Luguentz Dort", "Jalen Suggs", "PJ Washington", "RJ Barrett",
            "Khris Middleton", "Deandre Ayton", "Collin Sexton", "Dereck Lively", "Klay Thompson"
        ];

        // 球員照片映射表 - 完整的100名球員照片路徑
        const playerPhotoMappings = {
            // 前10名 (超級巨星)
            "Nikola Jokic": "photos/nikola-jokic.jpg",
            "Luka Doncic": "photos/luka-doncic.jpg", 
            "Shai Gilgeous-Alexander": "photos/shai-gilgeous-alexander.jpg",
            "Giannis Antetokounmpo": "photos/giannis-antetokounmpo.jpg",
            "Joel Embiid": "photos/joel-embiid.jpg",
            "Jayson Tatum": "photos/jayson-tatum.jpg",
            "Anthony Edwards": "photos/anthony-edwards.jpg",
            "Jalen Brunson": "photos/jalen-brunson.jpg",
            "Anthony Davis": "photos/anthony-davis.jpg",
            "Victor Wembanyama": "photos/victor-wembanyama.jpg",
            
            // 11-25名 (All-Star級別)
            "Kevin Durant": "photos/kevin-durant.jpg",
            "Tyrese Haliburton": "photos/tyrese-haliburton.jpg",
            "LeBron James": "photos/lebron-james.jpg",
            "Stephen Curry": "photos/stephen-curry.jpg",
            "Tyrese Maxey": "photos/tyrese-maxey.jpg",
            "Devin Booker": "photos/devin-booker.jpg",
            "Donovan Mitchell": "photos/donovan-mitchell.jpg",
            "Jaylen Brown": "photos/jaylen-brown.jpg",
            "Ja Morant": "photos/ja-morant.jpg",
            "Domantas Sabonis": "photos/domantas-sabonis.jpg",
            "Damian Lillard": "photos/damian-lillard.jpg",
            "Zion Williamson": "photos/zion-williamson.jpg",
            "Paolo Banchero": "photos/paolo-banchero.jpg",
            "De'Aaron Fox": "photos/deaaron-fox.jpg",
            "Pascal Siakam": "photos/pascal-siakam.jpg",
            
            // 26-50名 (明星球員)
            "Kawhi Leonard": "photos/kawhi-leonard.jpg",
            "Paul George": "photos/paul-george.jpg",
            "Bam Adebayo": "photos/bam-adebayo.jpg",
            "Trae Young": "photos/trae-young.jpg",
            "Jimmy Butler": "photos/jimmy-butler.jpg",
            "Karl-Anthony Towns": "photos/karl-anthony-towns.jpg",
            "Rudy Gobert": "photos/rudy-gobert.jpg",
            "Kyrie Irving": "photos/kyrie-irving.jpg",
            "Lauri Markkanen": "photos/lauri-markkanen.jpg",
            "Scottie Barnes": "photos/scottie-barnes.jpg",
            "Jamal Murray": "photos/jamal-murray.jpg",
            "Cade Cunningham": "photos/cade-cunningham.jpg",
            "Julius Randle": "photos/julius-randle.jpg",
            "Alperen Sengun": "photos/alperen-sengun.jpg",
            "Chet Holmgren": "photos/chet-holmgren.jpg",
            "LaMelo Ball": "photos/lamelo-ball.jpg",
            "Jaren Jackson Jr": "photos/jaren-jackson-jr.jpg",
            "Jalen Williams": "photos/jalen-williams.jpg",
            "Kristaps Porzingis": "photos/kristaps-porzingis.jpg",
            "DeMar DeRozan": "photos/demar-derozan.jpg",
            "Brandon Ingram": "photos/brandon-ingram.jpg",
            "James Harden": "photos/james-harden.jpg",
            "Franz Wagner": "photos/franz-wagner.jpg",
            "Desmond Bane": "photos/desmond-bane.jpg",
            "Derrick White": "photos/derrick-white.jpg",
            
            // 51-75名 (優質先發)
            "Evan Mobley": "photos/evan-mobley.jpg",
            "Darius Garland": "photos/darius-garland.jpg",
            "Myles Turner": "photos/myles-turner.jpg",
            "Jrue Holiday": "photos/jrue-holiday.jpg",
            "Dejounte Murray": "photos/dejounte-murray.jpg",
            "Mikal Bridges": "photos/mikal-bridges.jpg",
            "OG Anunoby": "photos/og-anunoby.jpg",
            "Brandon Miller": "photos/brandon-miller.jpg",
            "Aaron Gordon": "photos/aaron-gordon.jpg",
            "Jarrett Allen": "photos/jarrett-allen.jpg",
            "Kyle Kuzma": "photos/kyle-kuzma.jpg",
            "Zach LaVine": "photos/zach-lavine.jpg",
            "Austin Reaves": "photos/austin-reaves.jpg",
            "Michael Porter Jr": "photos/michael-porter-jr.jpg",
            "Jalen Green": "photos/jalen-green.jpg",
            "Fred VanVleet": "photos/fred-vanvleet.jpg",
            "Miles Bridges": "photos/miles-bridges.jpg",
            "Jalen Johnson": "photos/jalen-johnson.jpg",
            "Tyler Herro": "photos/tyler-herro.jpg",
            "Coby White": "photos/coby-white.jpg",
            "CJ McCollum": "photos/cj-mccollum.jpg",
            "Josh Giddey": "photos/josh-giddey.jpg",
            "Bradley Beal": "photos/bradley-beal.jpg",
            "Trey Murphy": "photos/trey-murphy.jpg",
            "D'Angelo Russell": "photos/dangelo-russell.jpg",
            
            // 76-100名 (實力角色球員)
            "Devin Vassell": "photos/devin-vassell.jpg",
            "Immanuel Quickley": "photos/immanuel-quickley.jpg",
            "Herb Jones": "photos/herb-jones.jpg",
            "Jaden McDaniels": "photos/jaden-mcdaniels.jpg",
            "Jerami Grant": "photos/jerami-grant.jpg",
            "Josh Hart": "photos/josh-hart.jpg",
            "Keegan Murray": "photos/keegan-murray.jpg",
            "Jonathan Kuminga": "photos/jonathan-kuminga.jpg",
            "Malik Monk": "photos/malik-monk.jpg",
            "Cam Thomas": "photos/cam-thomas.jpg",
            "Donte DiVincenzo": "photos/donte-divincenzo.jpg",
            "Anfernee Simons": "photos/anfernee-simons.jpg",
            "Jabari Smith Jr": "photos/jabari-smith-jr.jpg",
            "Nikola Vucevic": "photos/nikola-vucevic.jpg",
            "Tobias Harris": "photos/tobias-harris.jpg",
            "Naz Reid": "photos/naz-reid.jpg",
            "Luguentz Dort": "photos/luguentz-dort.jpg",
            "Jalen Suggs": "photos/jalen-suggs.jpg",
            "PJ Washington": "photos/pj-washington.jpg",
            "RJ Barrett": "photos/rj-barrett.jpg",
            "Khris Middleton": "photos/khris-middleton.jpg",
            "Deandre Ayton": "photos/deandre-ayton.jpg",
            "Collin Sexton": "photos/collin-sexton.jpg",
            "Dereck Lively": "photos/dereck-lively.jpg",
            "Klay Thompson": "photos/klay-thompson.jpg"
        };

        // 批量請求配置
        const BATCH_SIZE = 10; // 每批處理的球員數量
        const REQUEST_DELAY = 50; // 請求間隔(毫秒)，減少到50ms
        const MAX_CONCURRENT = 5; // 最大併發請求數

        // 球員姓名API映射表 - 處理特殊情況
        const playerNameMappings = {
            "Nikola Jokic": ["Nikola Jokic", "Nikola Jokić"],
            "Luka Doncic": ["Luka Doncic", "Luka Dončić", "Luka Dončic"],
            "Kristaps Porzingis": ["Kristaps Porzingis", "Kristaps Porziņģis", "Kristaps Porzinigis"],
            "Herb Jones": ["Herb Jones", "Herbert Jones", "Herbert Keyshawn Jones"],
            "Nikola Vucevic": ["Nikola Vucevic", "Nikola Vučević", "Nikola Vucevic"],
            "PJ Washington": ["PJ Washington", "P.J. Washington", "Paul Jamaine Washington"],
            "RJ Barrett": ["RJ Barrett", "R.J. Barrett", "Rowan Barrett Jr."],
            "CJ McCollum": ["CJ McCollum", "C.J. McCollum", "Christian James McCollum"],
            "OG Anunoby": ["OG Anunoby", "O.G. Anunoby", "Ogugua Anunoby"],
            "Alperen Sengun": ["Alperen Sengun", "Alperen Şengün"],
            "Jaren Jackson Jr": ["Jaren Jackson Jr", "Jaren Jackson Jr.", "Jaren Walter Jackson Jr."],
            "Karl-Anthony Towns": ["Karl-Anthony Towns", "Karl Anthony Towns"]
        };

        let allPlayers = [];
        let filteredPlayers = [];
        let currentPage = 1;
        const playersPerPage = 12;
        let currentDataType = 'advanced';

        // 頁面載入時初始化
        window.onload = function() {
            populateFilters();
            loadPlayers();
        };

        // 載入球員數據
        async function loadPlayers() {
            const loadingDiv = document.getElementById('loadingDiv');
            const errorDiv = document.getElementById('errorDiv');
            const playersContainer = document.getElementById('playersContainer');
            const statsSummary = document.getElementById('statsSummary');
            
            loadingDiv.style.display = 'block';
            errorDiv.style.display = 'none';
            playersContainer.innerHTML = '';
            statsSummary.style.display = 'none';
            
            currentDataType = document.getElementById('dataTypeSelect').value;
            const endpoint = currentDataType === 'advanced' ? 'PlayerDataAdvanced' : 'PlayerDataTotals';
            
            try {
                // 直接使用逐個載入方式，因為query端點的數據不完整
                console.log('使用逐個載入方式獲取球員數據...');
                await loadPlayersIndividually(endpoint);
                
            } catch (error) {
                console.error('載入球員數據時出錯:', error);
                loadingDiv.style.display = 'none';
                errorDiv.style.display = 'block';
                errorDiv.innerHTML = `
                    <h3>載入數據時發生錯誤</h3>
                    <p>${error.message}</p>
                    <p>可能的原因：</p>
                    <ul style="text-align: left; margin-top: 10px;">
                        <li>API服務器暫時無法訪問</li>
                        <li>網路連接問題</li>
                        <li>CORS政策限制</li>
                    </ul>
                    <button onclick="loadPlayers()" style="margin-top: 15px; background: white; color: #ff6b6b; border: 2px solid white;">重新載入</button>
                `;
            }
        }

        // 高速批量載入球員數據
        async function loadPlayersIndividually(endpoint) {
            const loadingDiv = document.getElementById('loadingDiv');
            const errorDiv = document.getElementById('errorDiv');
            
            allPlayers = [];
            let successCount = 0;
            let errorCount = 0;
            let currentBatch = 0;
            
            // 分批次處理，每批併發請求
            const totalBatches = Math.ceil(top100Players.length / BATCH_SIZE);
            
            for (let batchIndex = 0; batchIndex < totalBatches; batchIndex++) {
                const startIndex = batchIndex * BATCH_SIZE;
                const endIndex = Math.min(startIndex + BATCH_SIZE, top100Players.length);
                const batch = top100Players.slice(startIndex, endIndex);
                
                // 更新進度
                const progress = ((batchIndex + 1) / totalBatches * 100);
                loadingDiv.innerHTML = `
                    <div class="loading-spinner"></div>
                    🚀 高速載入中... ${progress.toFixed(0)}%
                    <br>正在處理第 ${batchIndex + 1}/${totalBatches} 批 (${batch.length} 位球員)
                    <br><small>已成功: ${successCount} | 失敗: ${errorCount}</small>
                `;
                
                // 併發處理當前批次
                const batchPromises = batch.map(async (playerName, batchPlayerIndex) => {
                    const playerIndex = startIndex + batchPlayerIndex;
                    return await loadSinglePlayer(playerName, playerIndex, endpoint);
                });
                
                // 等待當前批次完成
                const batchResults = await Promise.allSettled(batchPromises);
                
                // 統計結果
                batchResults.forEach((result, batchPlayerIndex) => {
                    const playerIndex = startIndex + batchPlayerIndex;
                    if (result.status === 'fulfilled' && result.value) {
                        allPlayers.push(result.value);
                        successCount++;
                    } else {
                        // 創建佔位符
                        const placeholder = {
                            playerName: top100Players[playerIndex],
                            team: 'N/A',
                            position: 'N/A',
                            age: 0,
                            season: 2024,
                            hoopsHypeRank: playerIndex + 1,
                            originalName: top100Players[playerIndex],
                            isPlaceholder: true
                        };
                        allPlayers.push(placeholder);
                        errorCount++;
                    }
                });
                
                // 實時更新顯示
                if (batchIndex % 2 === 0 || batchIndex === totalBatches - 1) {
                    allPlayers.sort((a, b) => a.hoopsHypeRank - b.hoopsHypeRank);
                    updateFilterOptions();
                    applyFilters();
                    updateStatsSummary();
                    document.getElementById('statsSummary').style.display = 'grid';
                }
                
                // 小延遲避免API限制
                if (batchIndex < totalBatches - 1) {
                    await new Promise(resolve => setTimeout(resolve, REQUEST_DELAY));
                }
            }
            
            console.log(`🎯 載入完成: 成功 ${successCount}/100 位球員 (${(successCount/100*100).toFixed(1)}%)`);
            
            // 最終整理和顯示
            allPlayers.sort((a, b) => a.hoopsHypeRank - b.hoopsHypeRank);
            updateFilterOptions();
            applyFilters();
            updateStatsSummary();
            
            loadingDiv.style.display = 'none';
            document.getElementById('statsSummary').style.display = 'grid';
            
            // 顯示結果統計
            if (errorCount > 0) {
                errorDiv.style.display = 'block';
                errorDiv.innerHTML = `
                    <h3>🎯 載入完成！</h3>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin: 15px 0;">
                        <div style="text-align: center; padding: 10px; background: #d4edda; border-radius: 10px;">
                            <div style="font-size: 2em; font-weight: bold; color: #155724;">${successCount}</div>
                            <div style="color: #155724;">成功載入</div>
                        </div>
                        <div style="text-align: center; padding: 10px; background: #f8d7da; border-radius: 10px;">
                            <div style="font-size: 2em; font-weight: bold; color: #721c24;">${errorCount}</div>
                            <div style="color: #721c24;">載入失敗</div>
                        </div>
                        <div style="text-align: center; padding: 10px; background: #d1ecf1; border-radius: 10px;">
                            <div style="font-size: 2em; font-weight: bold; color: #0c5460;">${(successCount/100*100).toFixed(1)}%</div>
                            <div style="color: #0c5460;">成功率</div>
                        </div>
                    </div>
                    <small>⚡ 使用高速並發載入技術</small>
                `;
            }
        }

        // 載入單個球員數據
        async function loadSinglePlayer(playerName, playerIndex, endpoint) {
            try {
                const nameVariants = playerNameMappings[playerName] || [playerName];
                
                for (const variant of nameVariants) {
                    const encodedName = encodeURIComponent(variant);
                    const response = await fetch(`http://rest.nbaapi.com/api/${endpoint}/name/${encodedName}`);
                    
                    if (response.ok) {
                        const playerData = await response.json();
                        if (Array.isArray(playerData) && playerData.length > 0) {
                            const latestData = playerData.sort((a, b) => b.season - a.season)[0];
                            latestData.hoopsHypeRank = playerIndex + 1;
                            latestData.originalName = playerName;
                            latestData.apiName = variant;
                            
                            console.log(`✅ ${playerIndex + 1}/100: ${playerName}`);
                            return latestData;
                        }
                    }
                }
                
                console.warn(`❌ ${playerIndex + 1}/100: ${playerName} - 未找到`);
                return null;
            } catch (error) {
                console.error(`💥 ${playerIndex + 1}/100: ${playerName} - 錯誤: ${error.message}`);
                return null;
            }
        }

        // 更新篩選器選項
        function updateFilterOptions() {
            const teamFilter = document.getElementById('teamFilter');
            
            // 獲取唯一的球隊
            const teams = [...new Set(allPlayers.map(p => p.team))].sort();
            teamFilter.innerHTML = '<option value="">所有球隊</option>' + 
                teams.map(team => `<option value="${team}">${team}</option>`).join('');
        }

        // 預設填充篩選器
        function populateFilters() {
            const teamFilter = document.getElementById('teamFilter');
            
            // 常見NBA球隊
            const commonTeams = ['LAL', 'GSW', 'BOS', 'MIA', 'CHI', 'NYK', 'LAC', 'PHX', 'DAL', 'MIL'];
            teamFilter.innerHTML = '<option value="">所有球隊</option>' + 
                commonTeams.map(team => `<option value="${team}">${team}</option>`).join('');
        }

        // 應用篩選
        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const teamFilter = document.getElementById('teamFilter').value;
            const rankFilter = document.getElementById('rankFilter').value;
            
            filteredPlayers = allPlayers.filter(player => {
                const matchesSearch = !searchTerm || 
                    player.playerName.toLowerCase().includes(searchTerm);
                const matchesTeam = !teamFilter || player.team === teamFilter;
                
                let matchesRank = true;
                if (rankFilter) {
                    const [min, max] = rankFilter.split('-').map(Number);
                    matchesRank = player.hoopsHypeRank >= min && player.hoopsHypeRank <= max;
                }
                
                return matchesSearch && matchesTeam && matchesRank;
            });
            
            currentPage = 1;
            displayPlayers();
        }

        // 顯示球員
        function displayPlayers() {
            const playersContainer = document.getElementById('playersContainer');
            const startIndex = (currentPage - 1) * playersPerPage;
            const endIndex = startIndex + playersPerPage;
            const playersToShow = filteredPlayers.slice(startIndex, endIndex);
            
            if (playersToShow.length === 0) {
                playersContainer.innerHTML = '<div class="no-results">找不到符合條件的球員</div>';
                document.getElementById('pagination').style.display = 'none';
                document.getElementById('paginationBottom').style.display = 'none';
                return;
            }
            
            playersContainer.innerHTML = playersToShow.map(player => createPlayerCard(player)).join('');
            updatePagination();
        }

        // 創建球員卡片
        function createPlayerCard(player) {
            const isAdvanced = currentDataType === 'advanced';
            const rank = player.hoopsHypeRank;
            
            let rankClass = '';
            if (rank <= 10) rankClass = 'top-10';
            else if (rank <= 25) rankClass = 'top-25';
            else if (rank <= 50) rankClass = 'top-50';
            
            // 處理佔位符數據
            if (player.isPlaceholder) {
                return `
                    <div class="player-card placeholder-card" onclick="flipCard(this)">
                        <div class="ranking-badge ${rankClass}">#${rank}</div>
                        <div class="card-inner">
                            <!-- 正面 -->
                            <div class="card-front">
                                <div class="player-photo">❓</div>
                                <div class="player-name">${player.playerName}</div>
                                <div class="player-team">數據不可用</div>
                                <div class="hoopshype-rank">HoopsHype #${rank}</div>
                                <div class="flip-hint">點擊翻轉卡片</div>
                            </div>
                            <!-- 背面 -->
                            <div class="card-back">
                                <div class="placeholder-content">
                                    <h3>⚠️ 數據載入失敗</h3>
                                    <p>無法從API獲取此球員的數據</p>
                                    <p>可能因為姓名格式差異導致</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // 生成球員照片URL（使用NBA Headshots API或佔位符）
            const playerPhotoUrl = getPlayerPhotoUrl(player.playerName);
            
            return `
                <div class="player-card" onclick="flipCard(this)">
                    <div class="ranking-badge ${rankClass}">#${rank}</div>
                    <div class="card-inner">
                        <!-- 正面 -->
                        <div class="card-front">
                            <div class="player-photo">
                                ${playerPhotoUrl ? 
                                    `<img src="${playerPhotoUrl}" alt="${player.playerName}" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;" onerror="handlePhotoError(this)">
                                     <div style="display: none; width: 100%; height: 100%; align-items: center; justify-content: center; font-size: 3em; background: rgba(255,255,255,0.1); border-radius: 50%;">🏀</div>` 
                                    : '<div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; font-size: 3em; background: rgba(255,255,255,0.1); border-radius: 50%;">🏀</div>'
                                }
                            </div>
                            <div class="player-name">${player.playerName}</div>
                            <div class="player-team">${player.team}</div>
                            <div class="hoopshype-rank">RANK #${rank}</div>
                            <div class="flip-hint">點擊查看數據 ↻</div>
                        </div>
                        
                        <!-- 背面 -->
                        <div class="card-back">
                            <div class="player-header">
                                <div class="player-name">${player.playerName}</div>
                                <div class="player-position">${player.position || 'N/A'}</div>
                            </div>
                            
                            <div class="player-info">
                                <div class="info-item">
                                    <span class="info-label">球隊:</span>
                                    <span class="info-value">${player.team}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">NBA排名:</span>
                                    <span class="info-value">#${rank}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">賽季:</span>
                                    <span class="info-value">${player.season}-${(player.season + 1).toString().slice(-2)}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">年齡:</span>
                                    <span class="info-value">${player.age || 'N/A'}</span>
                                </div>
                            </div>
                            
                            <div class="advanced-stats">
                                ${isAdvanced ? `
                                    <div class="stat-item">
                                        <div class="stat-value">${(player.per || 0).toFixed(1)}</div>
                                        <div class="stat-name">PER</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">${((player.tsPercent || 0) * 100).toFixed(1)}%</div>
                                        <div class="stat-name">TS%</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">${(player.usagePercent || 0).toFixed(1)}%</div>
                                        <div class="stat-name">USG%</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">${(player.winShares || 0).toFixed(1)}</div>
                                        <div class="stat-name">WS</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">${(player.vorp || 0).toFixed(1)}</div>
                                        <div class="stat-name">VORP</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">${(player.box || 0).toFixed(1)}</div>
                                        <div class="stat-name">BPM</div>
                                    </div>
                                ` : `
                                    <div class="stat-item">
                                        <div class="stat-value">${player.points || 0}</div>
                                        <div class="stat-name">得分</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">${player.assists || 0}</div>
                                        <div class="stat-name">助攻</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">${player.totalRb || player.rebounds || 0}</div>
                                        <div class="stat-name">籃板</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">${((player.fieldPercent || 0) * 100).toFixed(1)}%</div>
                                        <div class="stat-name">投籃%</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">${((player.threePercent || 0) * 100).toFixed(1)}%</div>
                                        <div class="stat-name">三分%</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">${player.steals || 0}</div>
                                        <div class="stat-name">抄截</div>
                                    </div>
                                `}
                            </div>
                            
                            <div class="flip-hint" style="margin-top: 15px;">點擊返回照片 ↻</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // 獲取球員照片URL
        function getPlayerPhotoUrl(playerName) {
            // 優先使用本地照片映射
            if (playerPhotoMappings[playerName]) {
                return playerPhotoMappings[playerName];
            }
            
            // 自動生成文件名格式（作為備用）
            try {
                const formattedName = playerName.toLowerCase()
                    .replace(/[^a-z\s]/g, '')
                    .replace(/\s+/g, '-');
                
                // 嘗試常見的文件格式
                const possiblePaths = [
                    `photos/${formattedName}.jpg`,
                    `photos/${formattedName}.png`,
                    `images/${formattedName}.jpg`,
                    `assets/players/${formattedName}.jpg`
                ];
                
                // 返回第一個可能的路徑（可以後續添加存在性檢查）
                return possiblePaths[0];
            } catch (error) {
                return null;
            }
        }

        // 檢查照片是否存在並處理錯誤
        function handlePhotoError(imgElement) {
            // 照片載入失敗時的處理
            imgElement.style.display = 'none';
            const fallbackDiv = imgElement.nextElementSibling;
            if (fallbackDiv) {
                fallbackDiv.style.display = 'flex';
            }
        }

        // 卡片翻轉功能
        function flipCard(cardElement) {
            cardElement.classList.toggle('flipped');
        }

        // 更新統計摘要
        function updateStatsSummary() {
            if (filteredPlayers.length === 0) return;
            
            const totalPlayers = filteredPlayers.length;
            const avgAge = (filteredPlayers.reduce((sum, p) => sum + (p.age || 0), 0) / totalPlayers).toFixed(1);
            const totalTeams = new Set(filteredPlayers.map(p => p.team)).size;
            
            let avgPER = 0;
            if (currentDataType === 'advanced') {
                avgPER = (filteredPlayers.reduce((sum, p) => sum + (p.per || 0), 0) / totalPlayers).toFixed(1);
            } else {
                avgPER = (filteredPlayers.reduce((sum, p) => sum + (p.points || 0), 0) / totalPlayers).toFixed(1);
            }
            
            document.getElementById('totalPlayers').textContent = totalPlayers;
            document.getElementById('avgAge').textContent = avgAge;
            document.getElementById('totalTeams').textContent = totalTeams;
            document.getElementById('avgPER').textContent = avgPER;
            
            // 更新標籤
            const perLabel = document.querySelector('#statsSummary .stat-card:last-child .stat-label');
            perLabel.textContent = currentDataType === 'advanced' ? '平均PER' : '平均得分';
        }

        // 更新分頁
        function updatePagination() {
            const totalPages = Math.ceil(filteredPlayers.length / playersPerPage);
            const pagination = document.getElementById('pagination');
            const paginationBottom = document.getElementById('paginationBottom');
            
            if (totalPages <= 1) {
                pagination.style.display = 'none';
                paginationBottom.style.display = 'none';
                return;
            }
            
            const paginationHTML = createPaginationHTML(totalPages);
            pagination.innerHTML = paginationHTML;
            paginationBottom.innerHTML = paginationHTML;
            pagination.style.display = 'flex';
            paginationBottom.style.display = 'flex';
        }

        function createPaginationHTML(totalPages) {
            let html = `<button class="page-btn" onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>‹</button>`;
            
            for (let i = 1; i <= totalPages; i++) {
                if (i === 1 || i === totalPages || (i >= currentPage - 2 && i <= currentPage + 2)) {
                    html += `<button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`;
                } else if (i === currentPage - 3 || i === currentPage + 3) {
                    html += `<span class="page-btn">...</span>`;
                }
            }
            
            html += `<button class="page-btn" onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>›</button>`;
            return html;
        }

        function changePage(page) {
            const totalPages = Math.ceil(filteredPlayers.length / playersPerPage);
            if (page >= 1 && page <= totalPages) {
                currentPage = page;
                displayPlayers();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // 清除篩選
        function clearFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('teamFilter').value = '';
            document.getElementById('rankFilter').value = '';
            applyFilters();
        }

        // 照片測試功能
        function testPhotos() {
            const testPlayers = [
                "Nikola Jokic", "Luka Doncic", "Shai Gilgeous-Alexander", 
                "Giannis Antetokounmpo", "Joel Embiid", "Jayson Tatum",
                "Anthony Edwards", "Jalen Brunson", "Anthony Davis", "Victor Wembanyama"
            ];
            
            const results = [];
            let checkedCount = 0;
            
            // 創建測試窗口
            const testWindow = document.createElement('div');
            testWindow.style.cssText = `
                position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
                background: white; padding: 30px; border-radius: 15px; 
                box-shadow: 0 20px 40px rgba(0,0,0,0.3); z-index: 1000;
                max-width: 600px; max-height: 80vh; overflow-y: auto;
            `;
            
            testWindow.innerHTML = `
                <h3>📸 照片載入測試</h3>
                <p>正在檢查前10名球員的照片...</p>
                <div id="testResults" style="margin: 20px 0;"></div>
                <div style="text-align: center;">
                    <button onclick="this.parentElement.parentElement.remove()" 
                            style="background: #dc3545; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
                        關閉
                    </button>
                </div>
            `;
            
            document.body.appendChild(testWindow);
            
            const resultsDiv = document.getElementById('testResults');
            
            testPlayers.forEach((playerName, index) => {
                const photoUrl = getPlayerPhotoUrl(playerName);
                const img = new Image();
                
                img.onload = function() {
                    results.push(`✅ ${playerName}: ${photoUrl}`);
                    checkedCount++;
                    updateTestResults();
                };
                
                img.onerror = function() {
                    results.push(`❌ ${playerName}: ${photoUrl} (文件不存在)`);
                    checkedCount++;
                    updateTestResults();
                };
                
                if (photoUrl) {
                    img.src = photoUrl;
                } else {
                    results.push(`⚠️ ${playerName}: 無照片映射`);
                    checkedCount++;
                    updateTestResults();
                }
            });
            
            function updateTestResults() {
                resultsDiv.innerHTML = `
                    <div style="margin-bottom: 15px;">
                        <strong>進度: ${checkedCount}/${testPlayers.length}</strong>
                    </div>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; font-family: monospace; font-size: 14px;">
                        ${results.join('<br>')}
                    </div>
                    ${checkedCount === testPlayers.length ? `
                        <div style="margin-top: 15px; padding: 15px; background: #e7f3ff; border-radius: 8px;">
                            <h4>💡 解決建議：</h4>
                            <ol style="text-align: left; margin: 10px 0;">
                                <li><strong>檢查文件位置：</strong>確保photos文件夾與HTML文件在同一目錄</li>
                                <li><strong>檢查文件名：</strong>確保照片文件名與上述顯示的完全匹配</li>
                                <li><strong>使用本地服務器：</strong>建議使用Live Server或類似工具運行</li>
                                <li><strong>上傳文件：</strong>可以使用下面的文件選擇器直接選擇照片</li>
                            </ol>
                        </div>
                    ` : ''}
                `;
            }
        }

        // 文件上傳處理功能
        function setupFileUpload() {
            const uploadDiv = document.createElement('div');
            uploadDiv.innerHTML = `
                <div style="margin: 20px 0; padding: 20px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                    <h4>📁 直接選擇球員照片</h4>
                    <input type="file" id="photoUpload" multiple accept="image/*" 
                           style="margin: 10px 0; padding: 10px; border: 2px dashed #ccc; border-radius: 5px;">
                    <p style="font-size: 0.9em; color: #666;">
                        選擇多張球員照片，系統會自動嘗試匹配球員姓名
                    </p>
                </div>
            `;
            
            document.querySelector('.container').insertBefore(uploadDiv, document.getElementById('statsSummary'));
            
            document.getElementById('photoUpload').addEventListener('change', handleFileUpload);
        }

        // 處理文件上傳
        function handleFileUpload(event) {
            const files = event.target.files;
            const uploadedPhotos = {};
            
            for (let file of files) {
                const fileName = file.name.toLowerCase().replace(/\.(jpg|jpeg|png)$/, '');
                const fileUrl = URL.createObjectURL(file);
                
                // 嘗試匹配球員名稱
                for (let playerName of top100Players) {
                    const normalizedPlayerName = playerName.toLowerCase()
                        .replace(/[^a-z\s]/g, '')
                        .replace(/\s+/g, '-');
                    
                    if (fileName.includes(normalizedPlayerName) || 
                        normalizedPlayerName.includes(fileName)) {
                        uploadedPhotos[playerName] = fileUrl;
                        console.log(`🎯 匹配成功: ${playerName} -> ${file.name}`);
                        break;
                    }
                }
            }
            
            // 更新照片映射並重新顯示
            Object.assign(window.uploadedPhotos = window.uploadedPhotos || {}, uploadedPhotos);
            
            if (Object.keys(uploadedPhotos).length > 0) {
                displayPlayers(); // 重新顯示球員卡片
                
                alert(`成功載入 ${Object.keys(uploadedPhotos).length} 張球員照片！\n\n匹配的球員：\n${Object.keys(uploadedPhotos).join('\n')}`);
            } else {
                alert('未能自動匹配任何球員照片。\n請確保文件名包含球員姓名。');
            }
        }

        // 修改照片獲取函數以支持上傳的照片
        function getPlayerPhotoUrl(playerName) {
            // 優先使用上傳的照片
            if (window.uploadedPhotos && window.uploadedPhotos[playerName]) {
                return window.uploadedPhotos[playerName];
            }
            
            // 然後使用預設的照片映射
            if (playerPhotoMappings[playerName]) {
                return playerPhotoMappings[playerName];
            }
            
            // 最後嘗試自動生成路徑
            try {
                const formattedName = playerName.toLowerCase()
                    .replace(/[^a-z\s]/g, '')
                    .replace(/\s+/g, '-');
                
                return `photos/${formattedName}.jpg`;
            } catch (error) {
                return null;
            }
        }

        // 事件監聽器
        document.getElementById('searchInput').addEventListener('input', applyFilters);
        document.getElementById('teamFilter').addEventListener('change', applyFilters);
        document.getElementById('rankFilter').addEventListener('change', applyFilters);
        document.getElementById('dataTypeSelect').addEventListener('change', loadPlayers);
    </script>
</body>
</html>